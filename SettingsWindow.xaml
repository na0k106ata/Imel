<ui:FluentWindow x:Class="Imel.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Title="Imel 設定" 
        Height="760" Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ExtendsContentIntoTitleBar="True"
        WindowBackdropType="Mica"
        Background="{x:Null}">

    <!-- 全体のマージンをさらに縮小 (16 -> 10) -->
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header -->
            <RowDefinition Height="*"/>
            <!-- Content -->
            <RowDefinition Height="Auto"/>
            <!-- Footer -->
        </Grid.RowDefinitions>

        <!-- ヘッダー (マージン 8 -> 4) -->
        <TextBlock Text="設定" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,4" />

        <!-- コンテンツエリア Padding (12 -> 10) -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="0,0,10,0">
            <StackPanel>

                <!-- 全般グループ -->
                <TextBlock Text="全般" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,2"/>

                <ui:CardControl Icon="{ui:SymbolIcon Rocket24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <TextBlock Text="スタートアップ" FontWeight="Medium" FontSize="13"/>
                            <TextBlock Text="Windows起動時に自動的に開始する" FontSize="11" Foreground="{DynamicResource TextFillColorTertiaryBrush}"/>
                        </StackPanel>
                    </ui:CardControl.Header>
                    <ui:ToggleSwitch Name="StartupSwitch" Click="StartupSwitch_Click"/>
                </ui:CardControl>

                <ui:CardControl Icon="{ui:SymbolIcon EyeOff24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <TextBlock Text="自動非表示" FontWeight="Medium" FontSize="13"/>
                            <TextBlock Text="マウスカーソル消失時に隠す (動画視聴等)" FontSize="11" Foreground="{DynamicResource TextFillColorTertiaryBrush}"/>
                        </StackPanel>
                    </ui:CardControl.Header>
                    <ui:ToggleSwitch Name="HideCursorSwitch" Click="HideCursorSwitch_Click"/>
                </ui:CardControl>

                <ui:CardControl Icon="{ui:SymbolIcon Timer24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <TextBlock Text="描画間隔" FontWeight="Medium" FontSize="13"/>
                            <TextBlock Text="小さいほどスムーズになります (推奨: 5-15ms)" FontSize="11" Foreground="{DynamicResource TextFillColorTertiaryBrush}"/>
                        </StackPanel>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Name="IntervalValueText" Text="10 ms" VerticalAlignment="Center" Width="35" TextAlignment="Right" Margin="0,0,8,0" FontSize="12"/>
                        <Slider Name="IntervalSlider" Minimum="2" Maximum="100" Width="110" 
                                TickFrequency="1" IsSnapToTickEnabled="True"
                                ValueChanged="IntervalSlider_ValueChanged"/>
                    </StackPanel>
                </ui:CardControl>

                <!-- 外観グループ (上マージン 8 -> 6) -->
                <TextBlock Text="外観" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,6,0,2"/>

                <!-- テーマ設定 -->
                <ui:CardControl Icon="{ui:SymbolIcon DarkTheme24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <TextBlock Text="テーマ" FontWeight="Medium" FontSize="13"/>
                            <TextBlock Text="アプリケーションの配色設定" FontSize="11" Foreground="{DynamicResource TextFillColorTertiaryBrush}"/>
                        </StackPanel>
                    </ui:CardControl.Header>
                    <ComboBox Name="ThemeCombo" SelectionChanged="ThemeCombo_SelectionChanged" Width="140" FontSize="12">
                        <ComboBoxItem Content="システム設定"/>
                        <ComboBoxItem Content="ライト (Light)"/>
                        <ComboBoxItem Content="ダーク (Dark)"/>
                    </ComboBox>
                </ui:CardControl>

                <ui:CardControl Icon="{ui:SymbolIcon Maximize24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <TextBlock Text="表示サイズ (倍率)" FontWeight="Medium" FontSize="13"/>
                        </StackPanel>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Name="ScaleValueText" Text="1.0 x" VerticalAlignment="Center" Width="35" TextAlignment="Right" Margin="0,0,8,0" FontSize="12"/>
                        <Slider Name="ScaleSlider" Minimum="0.5" Maximum="2.0" Width="110"
                                TickFrequency="0.1" IsSnapToTickEnabled="True"
                                ValueChanged="ScaleSlider_ValueChanged"/>
                    </StackPanel>
                </ui:CardControl>

                <!-- 文字色 -->
                <ui:CardControl Icon="{ui:SymbolIcon Color24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <TextBlock Text="文字色" FontWeight="Medium" VerticalAlignment="Center" FontSize="13"/>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <ComboBox Name="TextColorCombo" SelectionChanged="TextColorCombo_SelectionChanged" Width="110" Margin="0,0,8,0" VerticalAlignment="Center" FontSize="12">
                            <ComboBoxItem Content="白 (White)"/>
                            <ComboBoxItem Content="黒 (Black)"/>
                            <ComboBoxItem Content="赤 (Red)"/>
                            <ComboBoxItem Content="青 (Blue)"/>
                            <ComboBoxItem Content="緑 (Green)"/>
                            <ComboBoxItem Content="カスタム"/>
                        </ComboBox>

                        <ui:NumberBox Name="TextR" Maximum="255" Minimum="0" Width="55" ValueChanged="TextColorRGB_Changed" PlaceholderText="R" Margin="0,0,4,0" SpinButtonPlacementMode="Compact" FontSize="12"/>
                        <ui:NumberBox Name="TextG" Maximum="255" Minimum="0" Width="55" ValueChanged="TextColorRGB_Changed" PlaceholderText="G" Margin="0,0,4,0" SpinButtonPlacementMode="Compact" FontSize="12"/>
                        <ui:NumberBox Name="TextB" Maximum="255" Minimum="0" Width="55" ValueChanged="TextColorRGB_Changed" PlaceholderText="B" SpinButtonPlacementMode="Compact" FontSize="12"/>
                    </StackPanel>
                </ui:CardControl>

                <!-- 背景色 -->
                <ui:CardControl Icon="{ui:SymbolIcon PaintBrush24}" Margin="0,0,0,2">
                    <ui:CardControl.Header>
                        <StackPanel>
                            <TextBlock Text="背景色" FontWeight="Medium" FontSize="13"/>
                        </StackPanel>
                    </ui:CardControl.Header>
                    <StackPanel HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,2">
                            <ComboBox Name="BgColorCombo" SelectionChanged="BgColorCombo_SelectionChanged" Width="110" Margin="0,0,8,0" VerticalAlignment="Center" FontSize="12">
                                <ComboBoxItem Content="黒 (Black)"/>
                                <ComboBoxItem Content="白 (White)"/>
                                <ComboBoxItem Content="赤 (Red)"/>
                                <ComboBoxItem Content="青 (Blue)"/>
                                <ComboBoxItem Content="緑 (Green)"/>
                                <ComboBoxItem Content="カスタム"/>
                            </ComboBox>
                            <ui:NumberBox Name="BgR" Maximum="255" Minimum="0" Width="55" ValueChanged="BgColorRGB_Changed" PlaceholderText="R" Margin="0,0,4,0" SpinButtonPlacementMode="Compact" FontSize="12"/>
                            <ui:NumberBox Name="BgG" Maximum="255" Minimum="0" Width="55" ValueChanged="BgColorRGB_Changed" PlaceholderText="G" Margin="0,0,4,0" SpinButtonPlacementMode="Compact" FontSize="12"/>
                            <ui:NumberBox Name="BgB" Maximum="255" Minimum="0" Width="55" ValueChanged="BgColorRGB_Changed" PlaceholderText="B" SpinButtonPlacementMode="Compact" FontSize="12"/>
                        </StackPanel>

                        <Grid HorizontalAlignment="Right">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="透過率 (%)" VerticalAlignment="Center" FontSize="11" Margin="0,0,8,0"/>
                            <ui:NumberBox Grid.Column="1" Name="BgOpacity" Maximum="100" Minimum="0" Width="70" ValueChanged="BgOpacity_Changed" SpinButtonPlacementMode="Compact" FontSize="12"/>
                        </Grid>
                    </StackPanel>
                </ui:CardControl>

                <!-- 位置グループ (上マージン 8 -> 6) -->
                <TextBlock Text="位置調整" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,6,0,2"/>

                <ui:CardControl Icon="{ui:SymbolIcon ArrowMove24}">
                    <ui:CardControl.Header>
                        <TextBlock Text="オフセット (ピクセル)" FontWeight="Medium" FontSize="13"/>
                    </ui:CardControl.Header>
                    <StackPanel Orientation="Horizontal">
                        <StackPanel Orientation="Horizontal" Margin="0,0,12,0">
                            <TextBlock Text="X:" VerticalAlignment="Center" Margin="0,0,4,0" FontSize="12"/>
                            <ui:NumberBox Name="OffsetX" Width="70" ValueChanged="Offset_Changed" SpinButtonPlacementMode="Compact" FontSize="12"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Y:" VerticalAlignment="Center" Margin="0,0,4,0" FontSize="12"/>
                            <ui:NumberBox Name="OffsetY" Width="70" ValueChanged="Offset_Changed" SpinButtonPlacementMode="Compact" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                </ui:CardControl>

            </StackPanel>
        </ScrollViewer>

        <!-- フッター (上マージン 8 -> 4) -->
        <Grid Grid.Row="2" Margin="0,4,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <ui:Button Content="初期設定に戻す" Icon="{ui:SymbolIcon ArrowCounterclockwise24}" Appearance="Secondary" Click="ResetButton_Click" FontSize="12"/>
            <ui:Button Grid.Column="2" Content="閉じる" Appearance="Primary" Click="CloseButton_Click" Width="80" FontSize="12"/>
        </Grid>
    </Grid>
</ui:FluentWindow>