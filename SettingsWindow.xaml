<Window x:Class="Imel.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Imel 設定" 
        Width="320" 
        SizeToContent="Height"
        ResizeMode="NoResize" 
        WindowStartupLocation="CenterScreen"
        Background="#F9F9F9">

    <StackPanel Margin="15">

        <!-- スタートアップ設定 -->
        <TextBlock Text="全般" FontSize="11" FontWeight="Bold" Foreground="#555" Margin="0,0,0,5"/>
        <CheckBox Name="StartupCheckBox" Content="Windows起動時に自動的に開始する" 
                  FontSize="11" Margin="0,0,0,5" Click="StartupCheckBox_Click"/>
        <CheckBox Name="HideCursorCheckBox" Content="マウスカーソル消失時に隠す (動画視聴等)" 
                  FontSize="11" Margin="0,0,0,10" Click="HideCursorCheckBox_Click"/>

        <!-- 更新頻度設定 -->
        <Grid Margin="0,0,0,2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="描画間隔 (ms) - 小さいほどスムーズ" FontSize="11" VerticalAlignment="Center"/>
            <TextBlock Name="IntervalValueText" Text="10" Grid.Column="1" FontSize="11" FontWeight="Bold"/>
        </Grid>
        <Slider Name="IntervalSlider" Minimum="2" Maximum="100" Value="10"
                TickFrequency="1" IsSnapToTickEnabled="True"
                ValueChanged="IntervalSlider_ValueChanged" Margin="0,0,0,15"
                ToolTip="マウス追従の滑らかさを調整します (推奨: 5-15ms)"/>

        <!-- 文字色設定 -->
        <TextBlock Text="文字色" FontSize="11" FontWeight="Bold" Foreground="#555" Margin="0,0,0,5"/>
        <ComboBox Name="TextColorCombo" SelectedIndex="0" SelectionChanged="TextColorCombo_SelectionChanged" Margin="0,0,0,5" Padding="4" FontSize="11">
            <ComboBoxItem Content="白 (White)"/>
            <ComboBoxItem Content="黒 (Black)"/>
            <ComboBoxItem Content="赤 (Red)"/>
            <ComboBoxItem Content="青 (Blue)"/>
            <ComboBoxItem Content="緑 (Green)"/>
            <ComboBoxItem Content="カスタム (下記RGB指定)"/>
        </ComboBox>
        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="R:" FontSize="11" VerticalAlignment="Center" Margin="0,0,2,0"/>
            <TextBox Name="TextR" Width="30" FontSize="11" Margin="0,0,10,0" TextChanged="TextColorRGB_Changed"/>
            <TextBlock Text="G:" FontSize="11" VerticalAlignment="Center" Margin="0,0,2,0"/>
            <TextBox Name="TextG" Width="30" FontSize="11" Margin="0,0,10,0" TextChanged="TextColorRGB_Changed"/>
            <TextBlock Text="B:" FontSize="11" VerticalAlignment="Center" Margin="0,0,2,0"/>
            <TextBox Name="TextB" Width="30" FontSize="11" Margin="0,0,0,0" TextChanged="TextColorRGB_Changed"/>
        </StackPanel>

        <!-- 背景色設定 -->
        <TextBlock Text="背景色" FontSize="11" FontWeight="Bold" Foreground="#555" Margin="0,0,0,5"/>
        <ComboBox Name="BgColorCombo" SelectedIndex="0" SelectionChanged="BgColorCombo_SelectionChanged" Margin="0,0,0,5" Padding="4" FontSize="11">
            <ComboBoxItem Content="黒 (Black)"/>
            <ComboBoxItem Content="白 (White)"/>
            <ComboBoxItem Content="赤 (Red)"/>
            <ComboBoxItem Content="青 (Blue)"/>
            <ComboBoxItem Content="緑 (Green)"/>
            <ComboBoxItem Content="カスタム (下記RGB指定)"/>
        </ComboBox>
        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
            <TextBlock Text="R:" FontSize="11" VerticalAlignment="Center" Margin="0,0,2,0"/>
            <TextBox Name="BgR" Width="30" FontSize="11" Margin="0,0,10,0" TextChanged="BgColorRGB_Changed"/>
            <TextBlock Text="G:" FontSize="11" VerticalAlignment="Center" Margin="0,0,2,0"/>
            <TextBox Name="BgG" Width="30" FontSize="11" Margin="0,0,10,0" TextChanged="BgColorRGB_Changed"/>
            <TextBlock Text="B:" FontSize="11" VerticalAlignment="Center" Margin="0,0,2,0"/>
            <TextBox Name="BgB" Width="30" FontSize="11" Margin="0,0,0,0" TextChanged="BgColorRGB_Changed"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="背景透過率 (%):" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBox Name="BgOpacity" Width="40" FontSize="11" TextChanged="BgOpacity_Changed"/>
        </StackPanel>

        <!-- 位置調整 -->
        <TextBlock Text="位置調整 (ピクセル)" FontSize="11" FontWeight="Bold" Foreground="#555" Margin="0,0,0,5"/>
        <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
            <TextBlock Text="横 (X):" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBox Name="OffsetX" Width="50" FontSize="11" Margin="0,0,15,0" TextChanged="Offset_Changed"/>
            <TextBlock Text="縦 (Y):" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBox Name="OffsetY" Width="50" FontSize="11" Margin="0,0,0,0" TextChanged="Offset_Changed"/>
        </StackPanel>

        <!-- ボタン -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Button Content="初期設定に戻す" Click="ResetButton_Click" Height="25" Width="100" FontSize="11"/>
            <Button Grid.Column="2" Content="閉じる" Click="CloseButton_Click" Height="25" Width="80" FontSize="11"/>
        </Grid>
    </StackPanel>
</Window>